# 快速导出 (Quick Export) - Premiere Pro 智能导出插件

![Version](https://img.shields.io/badge/version-1.0.1-blue) ![Premiere Pro](https://img.shields.io/badge/Premiere%20Pro-25.6.3%2B-purple) ![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20macOS-lightgrey)

专为 Adobe Premiere Pro 设计的自动化导出工具。一键智能分析序列分辨率，自动匹配最佳预设，智能管理文件版本号，让视频交付流程标准化、自动化。

## 📦 版本信息

**当前版本**：V1.0.1 (2026-01-21)

### 🆕 V1.0.1 更新内容

#### 新增功能
- ✨ **自定义项目名称**：支持在导出前临时修改项目名称，版本号自动延续
- 🎨 **调色状态标记**：新增调色状态选择（已调色/未调色），导出文件名自动添加标记
  - 智能检测已有文件的调色状态并自动同步 UI
  - 支持标记：`已调色`、`调色`、`graded`、`cc` 等
- 📊 **精简信息显示**：移除大面积日志区域，改为顶部单行状态显示
  - 实时显示：项目名称 + 码率 + 版本号 + 调色状态
  - 更加简洁、专业的 UI 布局

#### 改进优化
- 🔄 一键刷新按钮，快速更新版本信息
- 📁 优化导出路径显示，可直接查看输出位置
- 🎯 更紧凑的 UI 布局，提升操作效率

## ✨ 主要功能

### 🎯 智能一键导出
- **自动化预设匹配**：无需手动设置，插件根据序列分辨率智能选择最佳参数：
  - **4K+ (长边 ≥ 3840px)**：自动应用 48Mbps高码率 H.264 预设，确保画质。
  - **1080p 及以下**：自动应用 10Mbps 标准 H.264 预设，平衡体积与画质。
- **多格式支持**：
  - **H.264 (MP4)**：通用交付格式，兼容性最佳。
  - **ProRes 422 (MOV)**：高画质数字中间片，适合存档或后续制作。
  - **ProRes 444 (MOV)**：支持 Alpha 透明通道，适合特效合成素材。

### 📁 自动文件管理与版本控制
- **智能目录创建**：自动在项目所在目录的上级创建 "导出" 文件夹，保持项目整洁。
- **自动版本迭代**：告别 "最终版"、"最最终版" 的混乱命名。插件自动检测并递增版本号：
  - 支持 `V1`, `V2`, `V3...` 标准格式（无限递增）。
  - 支持 `第一版`, `第二版`... 中文格式。
  - **智能命名示例**：
    ```
    输入: "宣传片_V1.mp4" -> 输出: "宣传片_10mbps_V2.mp4"
    带调色标记: "宣传片_10mbps_V3_已调色.mp4"
    ```
- **自定义项目名称**：支持导出前临时修改项目名称，且保持版本号延续。
- **调色状态管理**（🆕 V1.0.1）：
  - 手动选择当前导出的调色状态（已调色/未调色）。
  - 自动检测现有文件的调色标记并同步至 UI。
  - 导出文件名自动附加 `_已调色` 标记，便于区分交付阶段。

### 🖱️ 极简操作体验
- **单行状态显示**（🆕 V1.0.1）：顶部实时显示项目名称、码率、版本号、调色状态，一目了然。
- **一键刷新**（🆕 V1.0.1）：快速刷新版本信息和调色状态，无需重新加载插件。
- **一键直达**：导出完成后，点击按钮即可在 Finder (Mac) 或 资源管理器 (Windows) 中打开导出文件夹。
- **跨平台适配**：完美支持 macOS 和 Windows 双平台，路径自动转换，无缝切换。

## 🚀 安装使用

### 前置要求
- Adobe Premiere Pro 25.6.3 或更高版本
- UXP Developer Tools (UDT)

### 安装步骤

#### 方式一：使用插件包（推荐）
1. 双击项目根目录下的 `快速导出.ccx` 文件进行安装。
   > **注意**：部分系统可能需要使用开发者模式加载。

#### 方式二：开发者模式加载
1. 打开 **UXP Developer Tools**。
2. 点击 "Add Plugin"，选择本插件目录下的 `manifest.json`。
3. 点击 "Load" 加载插件。
4. 在 Premiere Pro 菜单栏选择 `Window > UXP Plugins > 快速导出`。

## 📖 使用指南

1. **准备项目**：打开 Premiere Pro 项目并保存。
2. **选中序列**：在时间轴或项目面板中选中要导出的序列。
3. **选择格式**：在插件面板选择目标格式（默认推荐 H.264）。
4. **自定义名称(可选)**：需要时可修改项目名称，版本号会自动跟随。
5. **一键导出**：点击 "开始导出"，等待进度条完成。
6. **查看文件**：点击 "打开导出文件夹" 快速定位输出文件。

## 🔧 技术特性

- **模块化架构**：基于纯 JavaScript 和 Adobe UXP API 构建，无第三方重型依赖。
- **原生性能**：直接调用 Premiere Pro 底层导出接口，稳定高效。
- **跨平台兼容**：Windows 和 macOS 代码库统一，自动处理文件系统差异。

## 🐛 故障排除与已知问题

### 常见问答
- **Q: 插件无法加载？**
  - A: 请确认 Premiere Pro 版本 ≥ 25.6.3，并在 UDT 中尝试 Reload。
- **Q: 导出失败？**
  - A: 请确保项目已保存（有明确的文件路径），且当前有活动的序列。

### ⚠️ 已知限制：授权弹窗
- **现象**：首次向新路径导出时，Premiere Pro 会弹出系统级授权对话框。
- **原因**：这是 Adobe UXP 平台的安全沙箱机制，无法通过代码绕过。
- **解决**：只需点击 "允许" 即可，后续导出相同路径不会再弹窗。

## ⚠️ 测试状态

- ✅ **macOS**：已通过完整测试。
- ✅ **Windows**：已通过完整测试。

## 🗂️ 项目结构

```
├── 快速导出.ccx            # 插件安装包
├── index.html              # UI 入口
├── main.js                 # 逻辑入口
├── eventHandler.js         # 事件处理中心
├── modules/                # 核心功能模块
│   ├── projectLocationDetector.js   # 路径检测
│   ├── exportFolderManager.js       # 目录管理
│   ├── resolutionDetector.js        # 智能预设匹配
│   ├── fileVersioner.js             # 版本控制核心
│   └── sequenceExporter.js          # 导出执行
└── epr/                    # 导出预设库 (.epr)
```

## 📝 开发说明

### 核心流程
1. **项目检测** (`projectLocationDetector`) - 获取项目文件路径
2. **文件夹管理** (`exportFolderManager`) - 创建/检查导出文件夹
3. **分辨率检测** (`resolutionDetector`) - 分析序列分辨率
4. **版本检测** (`fileVersioner`) - 扫描现有文件版本
5. **序列导出** (`sequenceExporter`) - 执行导出操作

### 扩展预设
如需添加新预设：
1. 在 PR 中制作并导出 `.epr` 预设文件。
2. 放入 `epr/` 目录。
3. 在 `sequenceExporter.js` 的映射表中注册即可。

> **注意**：目前 UXP API 暂不支持 HEVC/H.265 编码器预设。

## 💡 设计理念

这是一个基于**"强观点"**设计的高效工具。它不追求大而全的配置选项，而是将一套**经过实战验证的、标准化的专业交付工作流**固化为代码。

### 核心哲学：习惯产品化
这款插件是 "我的个人最佳实践" 的产品化呈现。它固化了我在高强度视频交付中总结的最可靠逻辑。如果不希望把时间浪费在手动命名、寻找路径和重复设置参数上，它将为你带来前所未有的流畅体验。

---

## 🙋 支持

如有问题或建议，欢迎提交 Issue 反馈。



