# 快速导出 - Premiere Pro UXP 插件

一键导出 Premiere Pro 序列的智能插件，自动管理导出预设、输出文件夹和智能文件版本控制。

## 💡 设计理念

这是一个基于我个人剪辑习惯的**"强观点"导出插件**。它不追求无限配置，而是将一种被验证过的高效工作流自动化。

### 核心理念

这是一个 **"我的习惯"产品化** 的插件。我把自己在高质量视频交付中最常用、最可靠的导出逻辑固化了下来。它可能不完全适合你，但如果我们的工作流相似，它会让你感到前所未有的顺畅。

---

## ✨ 主要功能

### 🎯 一键智能导出
- **自动预设选择**：根据序列分辨率自动选择合适的导出预设
  - 4K+ (长边 ≥ 3840px)：使用 48Mbps H.264 高质量预设
  - 1080p 及以下：使用 10Mbps H.264 标准预设
- **支持多种格式**：
  - H.264（默认）- 通用兼容格式
  - ProRes 422 - 数字中间片
  - ProRes 444 - 带 Alpha 通道

### 📁 智能文件管理
- **自动创建导出文件夹**：在项目文件夹的上级目录自动创建"导出"文件夹
- **智能版本控制**：自动检测现有文件版本并递增
  - 识别 `V1`, `V2`, `V3...` 格式（无上限）
  - 识别 `第一版`, `第二版`, `第三版...` 格式（仅支持到第十版）
  - 自动生成带码率后缀的新版本文件名
- **示例命名**：
  ```
  现有文件: 项目名称_V3.mp4
  新导出: 项目名称_10mbps_V4.mp4
  ```

### 🖱️ 便捷操作
- **一键打开导出文件夹**：导出完成后点击按钮快速访问文件位置
- **跨平台支持**：Mac (访达) 和 Windows (资源管理器) 自动适配

## 🚀 安装使用

### 前置要求
- Adobe Premiere Pro 25.6.3 或更高版本
- UXP Developer Tools (UDT)

### 安装步骤

#### 方式一：使用预构建插件包（推荐）

1. **安装插件包**
   - 双击根目录下的 `快速导出.ccx` 文件

#### 方式二：开发者模式加载

1. **下载插件**

2. **加载到 Premiere Pro**
   - 打开 **UXP Developer Tools** 应用
   - 点击 "Add Plugin"
   - 选择插件目录中的 `manifest.json` 文件
   - 点击 "Load"

3. **在 Premiere Pro 中访问**
   - 菜单：Window > UXP Plugins > 快速导出

## 📖 使用说明

1. **打开项目**：确保 Premiere Pro 项目已保存
2. **选择序列**：激活要导出的序列
3. **选择格式**：在插件面板中选择导出格式（默认 H.264）
4. **点击导出**：点击"开始导出"按钮
5. **查看结果**：导出完成后可点击"打开导出文件夹"按钮查看文件

## 🗂️ 项目结构

```
├── 快速导出.ccx            # 预构建插件包（⚠️ 未完整测试）
├── index.html              # 插件 UI 界面
├── main.js                 # 插件入口和主题管理
├── eventHandler.js         # UI 事件处理和工作流编排
├── moduleManager.js        # 模块导入管理
├── manifest.json           # 插件配置文件
├── style.css               # 样式文件
├── modules/                # 功能模块
│   ├── projectLocationDetector.js   # 项目位置检测
│   ├── exportFolderManager.js       # 导出文件夹管理
│   ├── resolutionDetector.js        # 分辨率检测
│   ├── fileVersioner.js             # 文件版本控制
│   ├── sequenceExporter.js          # 序列导出
│   ├── scriptRunner.js              # 文件夹打开工具
│   └── FileSystemHelper.js          # 文件系统辅助工具
└── epr/                    # 导出预设文件
    ├── h264匹配帧10mbps.epr
    ├── h264匹配帧48mbps.epr
    ├── ProRes 422.epr
    └── ProRes 444.epr
```

## 🔧 技术特点

- **纯 JavaScript**：无需构建工具或框架
- **模块化设计**：清晰的模块分离，易于维护和扩展
- **UXP API**：使用最新的 Adobe UXP 平台 API
- **跨平台**：Mac 和 Windows 路径处理自动适配
- **错误处理**：完善的错误捕获和用户友好的提示

## 🐛 故障排除

### 插件无法加载
- 确保 Premiere Pro 版本 ≥ 25.6.3
- 在 UDT 中点击 "Reload" 重新加载插件

### 导出失败
- 确保项目已保存（项目必须有文件路径）
- 检查序列是否为活动状态
- 查看控制台日志获取详细错误信息

### 无法打开文件夹
- 检查 `manifest.json` 中 `launchProcess.extensions` 是否包含 `""`
- 确保系统允许访问文件夹权限

### 已知问题：授权对话框（macOS 和 Windows）
- **安全弹窗**：首次打开不同路径的导出文件夹时，Premiere Pro 会弹出授权对话框请求访问权限
- **原因**：这是 Adobe Premiere Pro 的内置安全机制，由 UXP 平台控制
- **无法绕过**：此行为受 Adobe 安全策略限制，无法通过插件代码绕过
- **解决方案**：点击"允许"后，该路径将被 Premiere Pro 记住，不会再次弹窗

##✅ **Windows**：已完整测试，功能正常（存在上述已知授权对话框问题）

- ✅ **macOS**：已完整测试，功能正常（存在上述已知授权对话框问题）

## 📝 开发说明

### 核心工作流程

1. **项目检测** (`projectLocationDetector`) - 获取项目文件路径
2. **文件夹管理** (`exportFolderManager`) - 创建/检查导出文件夹
3. **分辨率检测** (`resolutionDetector`) - 分析序列分辨率
4. **版本检测** (`fileVersioner`) - 扫描现有文件版本
5. **序列导出** (`sequenceExporter`) - 执行导出操作
6. **文件夹打开** (`scriptRunner`) - 在系统中打开导出位置

### 添加新的导出预设

1. 在 Premiere Pro 中配置导出设置
2. 导出为 `.epr` 文件
3. 将文件放入 `epr/` 目录
4. 在 `sequenceExporter.js` 中添加预设映射

**⚠️ 编码器限制**：
- ✅ **已验证可用**：H.264、ProRes 422、ProRes 444
- ❌ **不支持**：HEVC/H.265 - Premiere Pro UXP API 目前不支持 HEVC 编码器的导出预设
- 建议使用 H.264 作为通用格式，ProRes 作为高质量/中间片格式

## 🙋 支持

如有问题或建议，请查看项目文档或提交 Issue。



